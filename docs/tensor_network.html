

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tensor network and its contractions &#8212; Alibaba Cloud Quantum Development Platform 0.1 documentation</title>
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="acqdp.circuit package" href="acqdp.circuit.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="acqdp.circuit.html" title="acqdp.circuit package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="Tutorial"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Alibaba Cloud Quantum Development Platform 0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Tensor network and its contractions</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tensor-network-and-its-contractions">
<h1>Tensor network and its contractions<a class="headerlink" href="#tensor-network-and-its-contractions" title="Permalink to this headline">¶</a></h1>
<p>This page serves as documentation for our main tensor network contraction engine.</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="tensor-valued-objects">
<h2>Tensor Valued Objects<a class="headerlink" href="#tensor-valued-objects" title="Permalink to this headline">¶</a></h2>
<p>A tensor is a multi-dimensional array of numbers. The number of dimensions associated to a tensor is called the <cite>rank</cite> of the tensor. For example, a tensor of rank 0 represent a scalar <span class="math notranslate nohighlight">\(T\)</span>. A tensor of rank 1 is a vector <span class="math notranslate nohighlight">\((T_i)_{i=0}^{d-1}\)</span>, and a tensor of rank 2 is a matrix <span class="math notranslate nohighlight">\((T_{ij})_{(i,j)\in [d_0]\times [d_1]}\)</span>. The dimension corresponds to each of the indices are called <cite>bond dimensions</cite> associated to the indices.</p>
<p>A tensor network represents a multi-linear map of multiple tensors that results in a new tensor. For example:</p>
<ul class="simple">
<li><p>The inner product of two vectors <span class="math notranslate nohighlight">\(U, V\)</span> can be expressed as <span class="math notranslate nohighlight">\(T = \sum_i U_i\cdot V_i\)</span>.</p></li>
<li><p>The outer product of two vectors <span class="math notranslate nohighlight">\(U, V\)</span> can be expressed as <span class="math notranslate nohighlight">\(T_{ij} = U_i\cdot V_j\)</span>.</p></li>
<li><p>The element-wise product of two vectors <span class="math notranslate nohighlight">\(U, V\)</span> can be expressed as <span class="math notranslate nohighlight">\(T_i = U_i\cdot V_i\)</span>.</p></li>
<li><p>The matrix product of two matrices <span class="math notranslate nohighlight">\(M, N\)</span> can be expressed as <span class="math notranslate nohighlight">\(T_{ij}=\sum_k U_{ik}\cdot V_{kj}\)</span>.</p></li>
</ul>
<p>Explicit expressions like above are good for sake of demonstrations, but more complex tensor networks could arise from various scenarios, including many-body physics, machine learning and quantum computation. There are several equivalent ways of expressing a tensor network:</p>
<ul class="simple">
<li><p>Einstein summation. An einstein summation takes the form <cite>[indices_0],[indices_1],…,[indices_k]-&gt;[indices_o]</cite>. Each term on the left hand side corresponds to the indices configuration of an operand, and the indices on the right hand side corresponds to the indices on the right hand side, also called the open indices. All matching indices are identified with each other, and the closed indices, i.e. the ones that do not appear on the right hand side, are being summed over. The four examples above, expressed in terms of the Einstein summation, are respectively <cite>i,i-&gt;</cite>, <cite>i,j-&gt;ij</cite>, <cite>i,i-&gt;i</cite>, <cite>ik,kj-&gt;ij</cite>. There is a more restrictive interpretation of the einstein summation that each index appears exactly twice in the expression and the right hand side is thus removed. We do not take such convention. Moreover, each edge can appear multiple times on the right hand side, and does not have to appear on the left hand side as long as each index is associated with a definite bond dimension.</p></li>
<li><p>Attributed Multi-hypergraph. A tensor network can be expressed as a multi-hypergraph, where each node corresponds to a tensor operand, and each hyperedge an index. This provides a graphical, intuitive representation of a tensor network.</p></li>
</ul>
<p>Our package not only supports the definition and manipulation of tensors and tensor networks, but also unary functions acting on a tensor and summation of tensors with the same shape. These extensions help us handle different scenarios where tensors appear naturally in an easier manner.</p>
<dl class="py class">
<dt id="acqdp.tensor_network.TensorValued">
<em class="property">class </em><code class="sig-prename descclassname">acqdp.tensor_network.</code><code class="sig-name descname">TensorValued</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_valued.html#TensorValued"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorValued" title="Permalink to this definition">¶</a></dt>
<dd><p>Interface for all <a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> objects, including <a class="reference internal" href="#acqdp.tensor_network.Tensor" title="acqdp.tensor_network.Tensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference internal" href="#acqdp.tensor_network.TensorNetwork" title="acqdp.tensor_network.TensorNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorNetwork</span></code></a>,
<a class="reference internal" href="#acqdp.tensor_network.TensorSum" title="acqdp.tensor_network.TensorSum"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorSum</span></code></a> and <a class="reference internal" href="#acqdp.tensor_network.TensorView" title="acqdp.tensor_network.TensorView"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorView</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>identifier</strong> – unique identifier for each <a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> object.</p></li>
<li><p><strong>dtype</strong> – A <a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> object is homogeneous, and contains elements described by a dtype object.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="acqdp.tensor_network.TensorValued.shape">
<em class="property">property </em><code class="sig-name descname">shape</code><a class="headerlink" href="#acqdp.tensor_network.TensorValued.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>The common property of all <a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> classes, indicating whether the bond dimensions for a tensor
valued object. A tensor valued object is semantically a multi-dimensionally array, and its dimensions can be
expressed as a tuple of integers. The tuple is called the shape of the tensor, whereas the length of the tuple
is the rank of the tensor.</p>
<p>In ACQDP, undetermined tensors and undetermined dimensions are allowed. In the former case, the shape of the tensor
will return <cite>None</cite>; in the latter case, some of the bond_dimensions appearing in the tuple could be <cite>None</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> or None</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p>NotImplementedError, ValueError</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorValued.is_valid">
<em class="property">property </em><code class="sig-name descname">is_valid</code><a class="headerlink" href="#acqdp.tensor_network.TensorValued.is_valid" title="Permalink to this definition">¶</a></dt>
<dd><p>The common property of all <a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> classes, indicating whether the <a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> object
is valid or not. In every step of a program, all existing <a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> object must be valid, otherwise
an exception should be thrown out.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p>NotImplementedError</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorValued.is_ready">
<em class="property">property </em><code class="sig-name descname">is_ready</code><a class="headerlink" href="#acqdp.tensor_network.TensorValued.is_ready" title="Permalink to this definition">¶</a></dt>
<dd><p>The common property of all <a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> classes, indicating whether the current
<a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> object is ready for contraction, i.e. whether it semantically represents a tensor with a
definite value. A <cite>TensorValued</cite> object needs to be ready upon contraction, but needs not to be ready throught
the construction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p>NotImplementedError()</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorValued.fix_index">
<code class="sig-name descname">fix_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em>, <em class="sig-param"><span class="n">fix_to</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span> &#x2192; acqdp.tensor_network.tensor_valued.TensorValued<a class="reference internal" href="_modules/acqdp/tensor_network/tensor_valued.html#TensorValued.fix_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorValued.fix_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Fix the given index to the given value. The result <a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> object would have the same type as
the original one, with rank 1 smaller than the original.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – The index to fix.</p></li>
<li><p><strong>fix_to</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – the value to assign to the given index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> – The <a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> object after fixing the given index.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p>NotImplementedError</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorValued.contract">
<code class="sig-name descname">contract</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/acqdp/tensor_network/tensor_valued.html#TensorValued.contract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorValued.contract" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the <a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> object to a <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p>NotImplementedError</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorValued.cast">
<code class="sig-name descname">cast</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dtype</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_valued.html#TensorValued.cast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorValued.cast" title="Permalink to this definition">¶</a></dt>
<dd><p>Cast the tensor valued object to a new underlying dtype.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="acqdp.tensor_network.Tensor">
<em class="property">class </em><code class="sig-prename descclassname">acqdp.tensor_network.</code><code class="sig-name descname">Tensor</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor.html#Tensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.Tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">acqdp.tensor_network.tensor_valued.TensorValued</span></code></p>
<p>A <a class="reference internal" href="#acqdp.tensor_network.Tensor" title="acqdp.tensor_network.Tensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a> is an array of numbers with multiple dimensions. The most basic examples of a <a class="reference internal" href="#acqdp.tensor_network.Tensor" title="acqdp.tensor_network.Tensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>
are a vector (1-dimensional arrays of numbers) and a matrix (2-dimensional arrays).</p>
<p>In our implementation, <a class="reference internal" href="#acqdp.tensor_network.Tensor" title="acqdp.tensor_network.Tensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a> is a subclass of <a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a>, where the value is stored in an
<cite>numpy.ndarray</cite>. All other <cite>TensorValued</cite> represent operations over the <a class="reference internal" href="#acqdp.tensor_network.Tensor" title="acqdp.tensor_network.Tensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a> objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><strong>_data</strong> – <cite>numpy.ndarray</cite> object representing the data corresponding to the tensor.</p>
</dd>
</dl>
<dl class="py method">
<dt id="acqdp.tensor_network.Tensor.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">data: numpy.ndarray = None</em>, <em class="sig-param">dtype: type = &lt;class 'complex'&gt;</em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)">None</a><a class="reference internal" href="_modules/acqdp/tensor_network/tensor.html#Tensor.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.Tensor.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor of a <a class="reference internal" href="#acqdp.tensor_network.Tensor" title="acqdp.tensor_network.Tensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a> object.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="acqdp.tensor_network.TensorSum">
<em class="property">class </em><code class="sig-prename descclassname">acqdp.tensor_network.</code><code class="sig-name descname">TensorSum</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_sum.html#TensorSum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorSum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">acqdp.tensor_network.tensor_valued.TensorValued</span></code></p>
<p>A <a class="reference internal" href="#acqdp.tensor_network.TensorSum" title="acqdp.tensor_network.TensorSum"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorSum</span></code></a> object represents the summation of multiple tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><strong>terms_by_name</strong> – a dictionary with key-value pairs, where the key is the name of a summand and the value is the
corresponding summand <a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> object.</p>
</dd>
</dl>
<dl class="py method">
<dt id="acqdp.tensor_network.TensorSum.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">terms=None</em>, <em class="sig-param">dtype: type = &lt;class 'complex'&gt;</em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)">None</a><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_sum.html#TensorSum.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorSum.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>The constructor of a <cite>TensorSum</cite> object.</p>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorSum.add_term">
<code class="sig-name descname">add_term</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">term</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tensor</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_sum.html#TensorSum.add_term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorSum.add_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a term to the summation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>term</strong> (<em>hashable</em>) – Name of the term to be added. If not given, an auto-assigned one will be given as the output.</p></li>
<li><p><strong>tensor</strong> (<a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> or None) – Value of the term to be added.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The name of the newly added term.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorSum.update_term">
<code class="sig-name descname">update_term</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">term</span></em>, <em class="sig-param"><span class="n">tensor</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_sum.html#TensorSum.update_term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorSum.update_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the value of a term in the summation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>term</strong> (<em>hashable</em>) – Name of the term to be updated.</p></li>
<li><p><strong>tensor</strong> (<a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a>) – New value of the term</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Name of the term to be updated.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorSum.remove_term">
<code class="sig-name descname">remove_term</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">term</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_sum.html#TensorSum.remove_term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorSum.remove_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a term from the summation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>term</strong> (<em>hashable</em>) – Name of the term to be removed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> Value of the removed term</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="acqdp.tensor_network.TensorView">
<em class="property">class </em><code class="sig-prename descclassname">acqdp.tensor_network.</code><code class="sig-name descname">TensorView</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_view.html#TensorView"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorView" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">acqdp.tensor_network.tensor_valued.TensorValued</span></code></p>
<dl class="simple">
<dt><a class="reference internal" href="#acqdp.tensor_network.TensorView" title="acqdp.tensor_network.TensorView"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorView</span></code></a> is a subclass of <a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> representing unary operations over another <a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a></dt><dd><p>object that preserves the shape of the tensor. Common examples include element-wise conjugation and normalization with
respect to the frobenius norm.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tn</strong> – the underlying <cite>TensorValued</cite> object where the unary operation is performed onto.</p></li>
<li><p><strong>func</strong> – the unary function to be applied.</p></li>
<li><p><strong>homomorphism</strong> – indicator whether the unary function is homomorphic to the addition and multiplication of tensors. If
so, the unary function can be broadcast to lower-level tensors, enabling potential simplification of the tensor
network structure.</p></li>
<li><p><strong>dtype</strong> – dtype for the tensor entries.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="acqdp.tensor_network.TensorView.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">tn</em>, <em class="sig-param">func=&lt;ufunc 'conjugate'&gt;</em>, <em class="sig-param">homomorphism=False</em>, <em class="sig-param">dtype=&lt;class 'complex'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_view.html#TensorView.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorView.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>The constructor of a <cite>TensorView</cite> object.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="acqdp.tensor_network.TensorNetwork">
<em class="property">class </em><code class="sig-prename descclassname">acqdp.tensor_network.</code><code class="sig-name descname">TensorNetwork</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_network.html#TensorNetwork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorNetwork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">acqdp.tensor_network.tensor_valued.TensorValued</span></code></p>
<p>A <a class="reference internal" href="#acqdp.tensor_network.TensorNetwork" title="acqdp.tensor_network.TensorNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorNetwork</span></code></a> is a collection of <a class="reference internal" href="#acqdp.tensor_network.Tensor" title="acqdp.tensor_network.Tensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, with indices from different tensors identified and
summed up to present a new tensor. An example of tensor network is two 2-tensors with a common edge representing the
matrix multiplication. A <a class="reference internal" href="#acqdp.tensor_network.TensorNetwork" title="acqdp.tensor_network.TensorNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorNetwork</span></code></a> is a graphical representation of an Einstein summation.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> – attributed <code class="xref py py-class docutils literal notranslate"><span class="pre">networkx.Graph</span></code> object, representing the attributed hypergraph of the tensor network as
a tanner graph.</p></li>
<li><p><strong>dtype</strong> – dtype of the <a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> object.</p></li>
<li><p><strong>open_edges</strong> – a list of edge names, indicating the outgoing wires of the tensor network.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="acqdp.tensor_network.TensorNetwork.contract">
<code class="sig-name descname">contract</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">preset</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_network.html#TensorNetwork.contract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorNetwork.contract" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the <a class="reference internal" href="#acqdp.tensor_network.TensorNetwork" title="acqdp.tensor_network.TensorNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorNetwork</span></code></a> object as an <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preset</strong> (<cite>“default”</cite>, <cite>“khp”</cite> or <cite>None</cite>.) – Select a preset mode. If set to <cite>default</cite>, will contract the tensor network with default ordering and
no post-processing. If set to <cite>khp</cite>, will invoke advanced KaHyPar-based contraction order finding routine. If set
to <cite>None</cite>, will read config file or input keyword arguments for order finding specifications.</p></li>
<li><p><strong>config</strong> (<cite>str</cite>) – File name for the config file. If preset option is not given and config file is given, the keyword
arguments will be ignored and the specification will be read from the config file.</p></li>
<li><p><strong>kwargs</strong> (<cite>dict</cite>) – If neither the preset option nor the config file name is given, the program will read the keyword
arguments for order finding specifications. See <a class="reference internal" href="#acqdp.tensor_network.OrderFinder" title="acqdp.tensor_network.OrderFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderFinder</span></code></a>, <a class="reference internal" href="#acqdp.tensor_network.Compiler" title="acqdp.tensor_network.Compiler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compiler</span></code></a>, <a class="reference internal" href="#acqdp.tensor_network.Contractor" title="acqdp.tensor_network.Contractor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Contractor</span></code></a> for
individual specifications.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorNetwork.find_order">
<code class="sig-name descname">find_order</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">output_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_network.html#TensorNetwork.find_order"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorNetwork.find_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a contraction scheme of the <a class="reference internal" href="#acqdp.tensor_network.TensorNetwork" title="acqdp.tensor_network.TensorNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorNetwork</span></code></a> object. Equivalent to
<cite>next(get_order_finder(**kwargs).find_order(self))</cite>. See <a class="reference internal" href="#acqdp.tensor_network.OrderFinder.find_order" title="acqdp.tensor_network.OrderFinder.find_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OrderFinder.find_order()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Input file name. When given, load the contraction scheme from the input file.</p></li>
<li><p><strong>output_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Output file name. When given, the contraction scheme found will be dumped into the file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#acqdp.tensor_network.ContractionScheme" title="acqdp.tensor_network.ContractionScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionScheme</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorNetwork.compile">
<code class="sig-name descname">compile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">order</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_network.html#TensorNetwork.compile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorNetwork.compile" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile a <a class="reference internal" href="#acqdp.tensor_network.ContractionScheme" title="acqdp.tensor_network.ContractionScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionScheme</span></code></a> corresponding to the <a class="reference internal" href="#acqdp.tensor_network.TensorNetwork" title="acqdp.tensor_network.TensorNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorNetwork</span></code></a> object into a runtime
executable contraction process as a <a class="reference internal" href="#acqdp.tensor_network.ContractionTask" title="acqdp.tensor_network.ContractionTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionTask</span></code></a>. Equivalent to
<cite>Compiler(**kwargs.get(‘compiler_params’, {})).compile(self, order)</cite> (See <a class="reference internal" href="#acqdp.tensor_network.Compiler.compile" title="acqdp.tensor_network.Compiler.compile"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Compiler.compile()</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference internal" href="#acqdp.tensor_network.ContractionTask" title="acqdp.tensor_network.ContractionTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionTask</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorNetwork.add_node">
<code class="sig-name descname">add_node</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">edges</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tensor</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">is_open</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_network.html#TensorNetwork.add_node"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorNetwork.add_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a node into the tensor network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">hashable</span></code>) – The name of the node to be added. If not provided, a new name will be assigned.</p></li>
<li><p><strong>edges</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code> – list of edges in the tensor network corresponding to the open edges of the new node. If
not given, defaults to edges <cite>[0, …, len(shape)]</cite>) – The edges the new tensor node is being connected to.</p></li>
<li><p><strong>tensor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tensor_network.tensor_valued.TensorValued</span></code>.) – The value of the newly added tensor.</p></li>
<li><p><strong>is_open</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Whether the new indices associated to the new node will be added to open_edges.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>hashable – Name of the node added. If none is given as input, return the one automatically signed.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p>ValueError – An existing node in the tensor network is being added.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p>IndexError – A node is added with ambiguous connection to the tensor network. Happens when neither the shape
of the tensor nor the connecting edges are given.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p>AssertionError – A mismatch in the bond dimensions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorNetwork.pop_node">
<code class="sig-name descname">pop_node</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_network.html#TensorNetwork.pop_node"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorNetwork.pop_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Pop a tensor node from the tensor network. This operation simply removes the node from the hypergraph.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dict – The dict containing all the information of the popped node, including its tensor and hyperedge
connections.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>node_name</strong> (<em>hashable</em>) – Name of the node to be popped.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorNetwork.remove_node">
<code class="sig-name descname">remove_node</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_network.html#TensorNetwork.remove_node"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorNetwork.remove_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a tensor node from the tensor network. The difference between removing a node and popping anode is
that popping a node does not change the output shape of the tensor network, while removing a node would result
in a new tensor-valued object, where all edges connected to the removed node are appended to the end of the open
edges list.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dict – The dict containing all the information of the removed node, including its tensor and hyperedge
connections.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>node_name</strong> (<em>hashable</em>) – Name of the node to be removed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorNetwork.update_node">
<code class="sig-name descname">update_node</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node_name</span></em>, <em class="sig-param"><span class="n">tensor</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_network.html#TensorNetwork.update_node"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorNetwork.update_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Update an existing node of the tensor network by another tensor-valued object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node_name</strong> (<em>hashable</em>) – Name of the node to be updated.</p></li>
<li><p><strong>tensor</strong> (<a class="reference internal" href="#acqdp.tensor_network.TensorValued" title="acqdp.tensor_network.TensorValued"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorValued</span></code></a> or <cite>None</cite>) – The new tensor to be put at the node. If <cite>None</cite>, the tensor must be updated with an actual value later
in order for the tensor network to be ready for contraction.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p>AssertionError – Node update results in a bond dimension mismatch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorNetwork.add_edge">
<code class="sig-name descname">add_edge</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">edge_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bond_dim</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_network.html#TensorNetwork.add_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorNetwork.add_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an index which is not in this tensor network before.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_name</strong> (<em>hashable</em>) – Name of the edge to be added. Will be automatically assigned if none is given.</p></li>
<li><p><strong>bond_dim</strong> (<cite>int</cite> or <cite>None</cite>) – Bond dimension of the edge. If set to <cite>None</cite>, the edge bond dimension will be wildcard until set
otherwise.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>hashable – Name of the newly added edge.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorNetwork.open_edge">
<code class="sig-name descname">open_edge</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">edge_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bond_dim</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_network.html#TensorNetwork.open_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorNetwork.open_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Append an edge to the list of open edges. If the edge does not exist, it will be created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_name</strong> (<em>hashable</em>) – Name of the edge to be opened.</p></li>
<li><p><strong>bond_dim</strong> (<cite>int</cite>) – Bond dimension of the edge. See <cite>add_edge</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorNetwork.close_edge">
<code class="sig-name descname">close_edge</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">edge_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_network.html#TensorNetwork.close_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorNetwork.close_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Make an edge closed. All appearances of the edge will be removed from the open edges list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>edge_name</strong> (<em>hashable</em>) – Edge to be closed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorNetwork.fix_edge">
<code class="sig-name descname">fix_edge</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">edge_name</span></em>, <em class="sig-param"><span class="n">fix_to</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">change_fix</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_network.html#TensorNetwork.fix_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorNetwork.fix_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Fix an edge to a fixed value. The tensor network structure is not yet modified; this method only puts an
attribute to the fixed hyperedges. The structure will be changed upon calling the <cite>fix</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_name</strong> (<em>hashable</em>) – Edge to be fixed to a specific value.</p></li>
<li><p><strong>fix_to</strong> (<cite>int</cite>) – the value the edge is fixed to. Should be an integer ranging from 0 to <cite>bond_dim - 1</cite>.</p></li>
<li><p><strong>change_fix</strong> (<cite>bool</cite>) – Mode of <cite>fix_edge</cite>. If <cite>change_fix</cite> is set to <cite>True</cite>, the edge will be fixed to the given value
regardless of how it is fixed previously. If set to <cite>False</cite>, the fix will apply together with the previous fix,
resulting in a zero tensor if the two fixes do not match.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorNetwork.merge_edges">
<code class="sig-name descname">merge_edges</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">edges</span></em>, <em class="sig-param"><span class="n">merge_to</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_network.html#TensorNetwork.merge_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorNetwork.merge_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge a list of edges as one single edge by identification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edges</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>) – The list of edges to be merged into one.</p></li>
<li><p><strong>merge_to</strong> (<em>hashable</em>) – The name of the edge all the edges are merged to. If set to <cite>None</cite>, the merged edges will appear
as <cite>edges[0]</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="acqdp.tensor_network.TensorNetwork.rewire">
<code class="sig-name descname">rewire</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node_name</span></em>, <em class="sig-param"><span class="n">leg</span></em>, <em class="sig-param"><span class="n">rewire_to</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/tensor_network.html#TensorNetwork.rewire"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.TensorNetwork.rewire" title="Permalink to this definition">¶</a></dt>
<dd><p>Rewire an outgoing edge of a tensor node to another edge in the tensor network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node_name</strong> (<em>hashable</em>) – Name of the tensor node for whom an outgoing edge is to be rewired.</p></li>
<li><p><strong>leg</strong> (<cite>int</cite>) – Index of the outgoing edge regarding the tensor node. Should be an integer ranging from <cite>0</cite> to
rank(t) - 1, t being the corresponding tensor.</p></li>
<li><p><strong>rewire_to</strong> (<em>hashable</em>) – The edge name in the tensor network to redirect the leg to. If <cite>None</cite>, it will be rewired to a newly
created edge.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="tensor-network-contraction-related">
<h2>Tensor Network Contraction Related<a class="headerlink" href="#tensor-network-contraction-related" title="Permalink to this headline">¶</a></h2>
<p>Given the tensor operands and the network hypergraph as inputs, <cite>tensor network contraction</cite> aims to evaluation of the tensor network. Tensor network contraction is a computationally hard problem (<span class="math notranslate nohighlight">\(\#P-complete\)</span>), but cleverly contracting intermediate-sized tensor networks are of great interest.</p>
<p>Our packages aims at efficient <cite>exact</cite> tensor network contraction, i.e. no approximation is made throughout the process. The contraction process consists of the following steps: order finding, runtime compilation and contraction.</p>
<a class="reference internal image-reference" href="_images/flowchart.png"><img alt="An illustration of the tensor network contraction routine" src="_images/flowchart.png" style="width: 700px;" /></a>
<div class="section" id="order-finding">
<h3>Order finding<a class="headerlink" href="#order-finding" title="Permalink to this headline">¶</a></h3>
<p>One way of tensor network contraction is to merge two tensor nodes into one at a time, until only one tensor is left as the outcome. The cost for such method is determined by the stepwise cost. Such method can be formulated as a binary contraction tree with each node representing a pairwise contraction step. Our algorithm uses the method first introduced in <a class="reference internal" href="#gk20" id="id1"><span>[GK20]</span></a> to construct efficient contraction trees using hypergraph decomposition. A preliminary order finding scheme is given in <code class="xref py py-class docutils literal notranslate"><span class="pre">OrderFinder</span></code> when the tensor network is relatively small. More advanced, hypergraph-decomposition-based order finding approach is given in <code class="xref py py-class docutils literal notranslate"><span class="pre">KHPOrderFinder</span></code>.</p>
<p>Sometimes, a fully serialized contraction tree can be too costly to be carried out due to time / space constraints; for a complex tensor network, it is possible that whatever contraction tree one finds would result in an intermediate result that is well beyond the space of a laptop. We introduced the idea of index slicing in <a class="reference internal" href="#czh-18" id="id2"><span>[CZH+18]</span></a> for parallelization that helps both on running the contraction scheme concurrently, and on relieving the hard space constraint. The slicing method is provided in the class <code class="xref py py-class docutils literal notranslate"><span class="pre">Slicer</span></code>, and integrated to the order finding scheme as <code class="xref py py-class docutils literal notranslate"><span class="pre">SlicedOrderFinder</span></code>.</p>
<p>As a result of its execution, a call to <cite>find_order</cite> would yield <code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionScheme</span></code>.</p>
<dl class="py class">
<dt id="acqdp.tensor_network.ContractionScheme">
<em class="property">class </em><code class="sig-prename descclassname">acqdp.tensor_network.</code><code class="sig-name descname">ContractionScheme</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">order</span></em>, <em class="sig-param"><span class="n">slices</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cost</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/contraction.html#ContractionScheme"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.ContractionScheme" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt><a class="reference internal" href="#acqdp.tensor_network.ContractionScheme" title="acqdp.tensor_network.ContractionScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionScheme</span></code></a> is an intermediate representation of a tensor network contraction, containing the pairwise</dt><dd><p>contraction orders, the hyperedges to be sliced, and the cost of the contraction. A <a class="reference internal" href="#acqdp.tensor_network.ContractionScheme" title="acqdp.tensor_network.ContractionScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionScheme</span></code></a> does
not contain tensor data.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – The pairwise sequential contraction order.</p></li>
<li><p><strong>slices</strong> – The hyperedges to be sliced for parallelism.</p></li>
<li><p><strong>cost</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionCost</span></code> – The time / space cost and number of sub-processes of the tensor network
contraction.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="acqdp.tensor_network.OrderFinder">
<em class="property">class </em><code class="sig-prename descclassname">acqdp.tensor_network.</code><code class="sig-name descname">OrderFinder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">order_method</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/order_finder.html#OrderFinder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.OrderFinder" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt><a class="reference internal" href="#acqdp.tensor_network.OrderFinder" title="acqdp.tensor_network.OrderFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderFinder</span></code></a> class is dedicated to finding a contraction scheme corresponding to a given tensor network structure.</dt><dd><p>The main method of an <a class="reference internal" href="#acqdp.tensor_network.OrderFinder" title="acqdp.tensor_network.OrderFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderFinder</span></code></a> is <cite>find_order</cite>, which takes a <cite>TensorNetwork</cite> as input, and yields a
generator of <cite>ContractionScheme</cite>.The base class offers preliminary order finding schemes. For more advanced
hypergraph-based approach, use <a class="reference internal" href="#acqdp.tensor_network.KHPOrderFinder" title="acqdp.tensor_network.KHPOrderFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">KHPOrderFinder</span></code></a>. For finding contraction schemes with sliced edges,
use <a class="reference internal" href="#acqdp.tensor_network.SlicedOrderFinder" title="acqdp.tensor_network.SlicedOrderFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">SlicedOrderFinder</span></code></a>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><strong>order_method</strong> – ‘default’ order contracts the tensor one by one by order; ‘vertical’ order contracts the tensor based
on the vertical ordering. When the tensor network is from a quantum circuit, the vertical order corresponds to the
tensor network contraction where the tensors connected to a qubit is first contracted together and then merged to a
main one according to a given order of the qubits.</p>
</dd>
</dl>
<dl class="py method">
<dt id="acqdp.tensor_network.OrderFinder.find_order">
<code class="sig-name descname">find_order</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tn</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/order_finder.html#OrderFinder.find_order"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.OrderFinder.find_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a contraction scheme for the input tensor network subject to the constraints given in the
<a class="reference internal" href="#acqdp.tensor_network.OrderFinder" title="acqdp.tensor_network.OrderFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderFinder</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tn</strong> (<a class="reference internal" href="#acqdp.tensor_network.TensorNetwork" title="acqdp.tensor_network.TensorNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorNetwork</span></code></a>) – A tensor network for which the contraction scheme is to be determined.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#acqdp.tensor_network.ContractionScheme" title="acqdp.tensor_network.ContractionScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionScheme</span></code></a> containing the pairwise contraction order, a list of edges to be sliced, and
optionally the total contraction cost.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="acqdp.tensor_network.KHPOrderFinder">
<em class="property">class </em><code class="sig-prename descclassname">acqdp.tensor_network.</code><code class="sig-name descname">KHPOrderFinder</code><span class="sig-paren">(</span><em class="sig-param">num_threads=28</em>, <em class="sig-param">num_iters=50</em>, <em class="sig-param">num_cmas=1</em>, <em class="sig-param">cma_args=&lt;dict&gt;</em>, <em class="sig-param">eps=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/kahypar_order_finder.html#KHPOrderFinder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.KHPOrderFinder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">acqdp.tensor_network.order_finder.OrderFinder</span></code></p>
<dl class="simple">
<dt><a class="reference internal" href="#acqdp.tensor_network.KHPOrderFinder" title="acqdp.tensor_network.KHPOrderFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">KHPOrderFinder</span></code></a> utilizes hypergraph decomposition and cma-es opmization scheme for finding contraction orders for</dt><dd><p>intermediate-size tensor networks.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_threads</strong> – Number of threads to concurrently search for the best order.</p></li>
<li><p><strong>num_iters</strong> – Number of iterations for cma optimization.</p></li>
<li><p><strong>num_cmas</strong> – Number of times cma-es optimization scheme is called for exploring better parameter combinations.</p></li>
<li><p><strong>cma_args</strong> – Arguments for cma-es optimization scheme. See the documentation of cma for more details</p></li>
<li><p><strong>eps</strong> – In case a good parameter combination is already known, inputting a eps would skip the cma optimization scheme
and directly yield orders found by hypergraph decomposition.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="acqdp.tensor_network.SlicedOrderFinder">
<em class="property">class </em><code class="sig-prename descclassname">acqdp.tensor_network.</code><code class="sig-name descname">SlicedOrderFinder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">base_order_finder</span><span class="o">=</span><span class="default_value">{'order_finder_name': 'khp'}</span></em>, <em class="sig-param"><span class="n">slicer</span><span class="o">=</span><span class="default_value">{'slicer_name': 'default'}</span></em>, <em class="sig-param"><span class="n">num_candidates</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/order_finder.html#SlicedOrderFinder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.SlicedOrderFinder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">acqdp.tensor_network.order_finder.OrderFinder</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Class</dt>
<dd class="field-odd"><p><cite>SlicedOrderFinder</cite> finds a sliced contraction scheme based on unsliced contraction schemes found by its base
order finder.</p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>base_order_finder</strong> – The base order finder of the sliced order finder, from which the <cite>SlicedOrderFinder</cite> fetches
contraction schemes and do slicing on it.</p></li>
<li><p><strong>slicer</strong> – The slicing algorithm acting upon the contraction schemes.</p></li>
<li><p><strong>num_candidates</strong> – Number of unsliced contraction schemes to feed to the slicer at a time. Set to 20 by default.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="acqdp.tensor_network.Slicer">
<em class="property">class </em><code class="sig-prename descclassname">acqdp.tensor_network.</code><code class="sig-name descname">Slicer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_iter_before</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">num_iter_middle</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">num_iter_after</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">max_tw</span><span class="o">=</span><span class="default_value">29</span></em>, <em class="sig-param"><span class="n">max_num_slice</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">num_threads</span><span class="o">=</span><span class="default_value">28</span></em>, <em class="sig-param"><span class="n">slice_thres</span><span class="o">=</span><span class="default_value">0.02</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/slicer.html#Slicer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.Slicer" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#acqdp.tensor_network.Slicer" title="acqdp.tensor_network.Slicer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Slicer</span></code></a> finds slicing of an unsliced contraction scheme when called by the <a class="reference internal" href="#acqdp.tensor_network.SlicedOrderFinder" title="acqdp.tensor_network.SlicedOrderFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">SlicedOrderFinder</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_iter_before</strong> – Number of iterations of local optimization before slicing.</p></li>
<li><p><strong>num_iter_before</strong> – Number of iterations of local optimization in the middle of slicing.</p></li>
<li><p><strong>num_iter_before</strong> – Number of iterations of local optimization after slicing.</p></li>
<li><p><strong>max_num_slice</strong> – Maxmimum number of edges to be sliced. If set to -1, the constraint will be ignored.</p></li>
<li><p><strong>num_threads</strong> – Number of threads for multi-processing.</p></li>
<li><p><strong>slice_thres</strong> – Automatically slice edges that introduce an overhed below this threshold. Set to 0.02 by default.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="acqdp.tensor_network.MPSlicer">
<em class="property">class </em><code class="sig-prename descclassname">acqdp.tensor_network.</code><code class="sig-name descname">MPSlicer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_iter_before</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">num_iter_middle</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">num_iter_after</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">max_tw</span><span class="o">=</span><span class="default_value">29</span></em>, <em class="sig-param"><span class="n">max_num_slice</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">num_threads</span><span class="o">=</span><span class="default_value">28</span></em>, <em class="sig-param"><span class="n">slice_thres</span><span class="o">=</span><span class="default_value">0.02</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/slicer.html#MPSlicer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.MPSlicer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">acqdp.tensor_network.slicer.Slicer</span></code></p>
<p>Multi-processing slicing, by concurrently trying different slicing routes.</p>
</dd></dl>

<dl class="py class">
<dt id="acqdp.tensor_network.LocalOptimizer">
<em class="property">class </em><code class="sig-prename descclassname">acqdp.tensor_network.</code><code class="sig-name descname">LocalOptimizer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">size</span><span class="o">=</span><span class="default_value">13</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/local_optimizer.html#LocalOptimizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.LocalOptimizer" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt><a class="reference internal" href="#acqdp.tensor_network.LocalOptimizer" title="acqdp.tensor_network.LocalOptimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalOptimizer</span></code></a> takes a pairwise contraction tree and do local optimization on the tree. Note that a connected</dt><dd><p>subgraph of the contraction tree represents a sequence of intermediate steps that take some (potentially intermediate)
tensors as input, and outputs a later intermediate tensor. This sequence of steps can be optimized based on solely the
shapes of the input and output tensors associated to the subgraph, without looking at the rest of the contraction
tree. This allows local reorganization of the tree.</p>
</dd>
</dl>
<p>Each iteration of local optimization consists of two steps: In the first step, the contraction tree is divided into
non-overlapping subgraphs each up to a given size, with the internal connections in the subgraphs removed. The internal
connections are then reconstructed in the second phase using accelerated optimum contraction tree finding approach. The
iterations can be repeated by each time randomly selecting a different patch of subgraph division.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> – The maximum number of nodes to be included in one subgraph.</p></li>
<li><p><strong>resolver</strong> – The resolver to help reconstruct the pairwise order from subgraph divisions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="runtime-specific-optimizations">
<h3>Runtime-specific optimizations<a class="headerlink" href="#runtime-specific-optimizations" title="Permalink to this headline">¶</a></h3>
<p>A good contraction scheme involving sliced edges and pairwise contraction order might seem appealing in theory, but further work needs to be done for fully unleash the potential of the hardware to carry out such contraction efficiently. The <code class="xref py py-class docutils literal notranslate"><span class="pre">Compiler</span></code> aims to minimize the inefficiencies introduced by small-tensor operations, which take up a majority of number of steps and can not make full use of the existing hardwares. More specifically, <code class="xref py py-class docutils literal notranslate"><span class="pre">Compiler</span></code> does the following processing to increase the overall efficiency.</p>
<ul class="simple">
<li><p>Pre-computation. A typical contraction order has a stem-branch structure, i.e. it consists of a majority of small tensor multiplications (i.e. branches), and a few operations involving a big tensor obsorbing small tensors step by step (i.e. the stem). It is often the case that the stem requires too much memory that slicing becomes necessary, but the branches would need to be computed many times as a result. Although this does not add too much in the theoretical cost, it takes up a large amount of total time. To avoid this, <code class="xref py py-class docutils literal notranslate"><span class="pre">Compiler</span></code> moves the small tensor multiplications <em>before</em> slicing. As it only has to be done ones prior to all slicing, the inefficiencies caused by small tensor operation is almost entirely reduces. These small tensor operations are then called pre-computation as they happen before slicing and the contractions on the stem.</p></li>
<li><p>Branch merging. A typical contraction step on the stem is that the stem tensor (typically a big one) absorbs a small one as a result of contracting the corresponding branch. The branch tensor is sometimes so small that the multiplication cannot make full use of the GPU to achieve high-efficiency tensor contraction. One way to get around this is to slightly relax the floating point operations constraint, and merge two adjacent tensors together to form a bigger tensor, and then contract it to the stem.</p></li>
</ul>
<dl class="py class">
<dt id="acqdp.tensor_network.ContractionTask">
<em class="property">class </em><code class="sig-prename descclassname">acqdp.tensor_network.</code><code class="sig-name descname">ContractionTask</code><span class="sig-paren">(</span><em class="sig-param">output</em>, <em class="sig-param">inputs=None</em>, <em class="sig-param">commands=None</em>, <em class="sig-param">data=None</em>, <em class="sig-param">length=1</em>, <em class="sig-param">shape=None</em>, <em class="sig-param">fix_dict=None</em>, <em class="sig-param">open_edges=None</em>, <em class="sig-param">sub_outputs=None</em>, <em class="sig-param">cnt=0</em>, <em class="sig-param">dtype=&lt;class 'complex'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/contraction.html#ContractionTask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.ContractionTask" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt><a class="reference internal" href="#acqdp.tensor_network.ContractionTask" title="acqdp.tensor_network.ContractionTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionTask</span></code></a> is post-compilation intermediate representation for tensor network contraction, with all the</dt><dd><p>information necessary to carry out a tensor network contraction, including initial tensor data and stepwise
instruction of the contraction.</p>
</dd>
</dl>
<dl class="py method">
<dt id="acqdp.tensor_network.ContractionTask.execute">
<code class="sig-name descname">execute</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/contraction.html#ContractionTask.execute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.ContractionTask.execute" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a <a class="reference internal" href="#acqdp.tensor_network.ContractionTask" title="acqdp.tensor_network.ContractionTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionTask</span></code></a>.</p>
<p>Equivalent to <code class="xref py py-meth docutils literal notranslate"><span class="pre">Contractor(**kwargs).execute(self)()</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="acqdp.tensor_network.Compiler">
<em class="property">class </em><code class="sig-prename descclassname">acqdp.tensor_network.</code><code class="sig-name descname">Compiler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reorg_thres</span><span class="o">=</span><span class="default_value">23</span></em>, <em class="sig-param"><span class="n">patch_size</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">do_patch</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/compiler.html#Compiler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.Compiler" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile a <a class="reference internal" href="#acqdp.tensor_network.ContractionScheme" title="acqdp.tensor_network.ContractionScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionScheme</span></code></a> indicating contraction scheme and sliced edges into a
<a class="reference internal" href="#acqdp.tensor_network.ContractionTask" title="acqdp.tensor_network.ContractionTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionTask</span></code></a>, a hardware-aware format that can be readily used for tensor network contraction.</p>
<p>Typically, a <a class="reference internal" href="#acqdp.tensor_network.ContractionScheme" title="acqdp.tensor_network.ContractionScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionScheme</span></code></a> found by one of the <a class="reference internal" href="#acqdp.tensor_network.OrderFinder" title="acqdp.tensor_network.OrderFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderFinder</span></code></a> only aims to minimize the theoretical
floating number operations and / or largest size of intermediate tensors. Although those are typically accurate indicators
of the overall contracion cost, they fail to accomodate inefficiencies from elsewhere. The compiler takes care of
machine-related inefficiencies by slightly modifying the order.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>do_patch</strong> – If set to false, the patching and reorganization of the contraction order below will be skipped.</p></li>
<li><p><strong>patch_size</strong> – Whenever two adjacent branches both have size less than the patch size, the branches are merged
together. This is to avoid inefficiency called by skewed tensor shapes in tensor multiplication, with a slight
sacrifice in floating number operations.</p></li>
<li><p><strong>reorg_thres</strong> – Threshold for contraction order reorganization. The order is seperated into small tensor
multiplications and large tensor multiplications. All pairwise tensor multiplications involving tensors with size
less than <cite>reorg_thres</cite> will be put forward whenever possible.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="acqdp.tensor_network.Compiler.compile">
<code class="sig-name descname">compile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tn</span></em>, <em class="sig-param"><span class="n">scheme</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/compiler.html#Compiler.compile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.Compiler.compile" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tn</strong> (<a class="reference internal" href="#acqdp.tensor_network.TensorNetwork" title="acqdp.tensor_network.TensorNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorNetwork</span></code></a>) – The <a class="reference internal" href="#acqdp.tensor_network.TensorNetwork" title="acqdp.tensor_network.TensorNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorNetwork</span></code></a> the input contraction scheme is based on.</p></li>
<li><p><strong>scheme</strong> (<a class="reference internal" href="#acqdp.tensor_network.ContractionScheme" title="acqdp.tensor_network.ContractionScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionScheme</span></code></a>) – The contraction scheme from which the task is generated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#acqdp.tensor_network.ContractionTask" title="acqdp.tensor_network.ContractionTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionTask</span></code></a> – The compiled contraction task ready for execution.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="contraction">
<h3>Contraction<a class="headerlink" href="#contraction" title="Permalink to this headline">¶</a></h3>
<p>Finally, <code class="xref py py-class docutils literal notranslate"><span class="pre">Contractor</span></code> makes use of GPU, with the help of <cite>jax</cite> and <cite>opt_einsum</cite> to further increase the efficiency.</p>
<dl class="py class">
<dt id="acqdp.tensor_network.Contractor">
<em class="property">class </em><code class="sig-prename descclassname">acqdp.tensor_network.</code><code class="sig-name descname">Contractor</code><span class="sig-paren">(</span><em class="sig-param">exeEngine=None</em>, <em class="sig-param">backend='default'</em>, <em class="sig-param">dtype=&lt;class 'complex'&gt;</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/contractor.html#Contractor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.Contractor" title="Permalink to this definition">¶</a></dt>
<dd><p>Contractor class for tensor network contraction takes a <a class="reference internal" href="#acqdp.tensor_network.ContractionTask" title="acqdp.tensor_network.ContractionTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContractionTask</span></code></a> object and execute it
sequentially. For <code class="xref py py-class docutils literal notranslate"><span class="pre">NetworkContractionTask</span></code>, multi-processing is available for further accelarate the
computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>backend</strong> – When set to <cite>jax</cite>, large tensor contractions will make use of the <cite>jax</cite> backend. <cite>numpy.einsum</cite> is used
otherwise.</p></li>
<li><p><strong>exeEngine</strong> – Extension interface for other contraction backends. Set to <cite>None</cite> by default. When set to <cite>parallel</cite>,
subtasks will be computed simultaneously.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="acqdp.tensor_network.Contractor.execute">
<code class="sig-name descname">execute</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tasks</span></em>, <em class="sig-param"><span class="n">lst</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/acqdp/tensor_network/contractor.html#Contractor.execute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#acqdp.tensor_network.Contractor.execute" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a contraction task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tasks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">acqdp.ContractionScheme</span></code>) – The task to be executed.</p></li>
<li><p><strong>lst</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>) – The list of subtasks to be executed. If set to <cite>None</cite>, all subtasks are executed and merged together.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> – Final result expressed as a multi-dimensional array.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="section" id="references">
<h4>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h4>
<dl class="citation">
<dt class="label" id="gk20"><span class="brackets"><a class="fn-backref" href="#id1">GK20</a></span></dt>
<dd><p>Johnnie Gray, and Stefanos Kourtis, <em>Hyper-optimized tensor network contraction</em>, arXiv preprint arXiv:2002.01935, 2020.</p>
</dd>
<dt class="label" id="czh-18"><span class="brackets"><a class="fn-backref" href="#id2">CZH+18</a></span></dt>
<dd><p>Jianxin Chen, Fang Zhang, Cupjin Huang, Michael Newman, and Yaoyun Shi, <em>Classical simulation of intermediate-size quantum circuits</em>, arXiv preprint arXiv:1805.01450, 2018.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tensor network and its contractions</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#tensor-valued-objects">Tensor Valued Objects</a></li>
<li><a class="reference internal" href="#tensor-network-contraction-related">Tensor Network Contraction Related</a><ul>
<li><a class="reference internal" href="#order-finding">Order finding</a></li>
<li><a class="reference internal" href="#runtime-specific-optimizations">Runtime-specific optimizations</a></li>
<li><a class="reference internal" href="#contraction">Contraction</a><ul>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tutorial.html"
                        title="previous chapter">Tutorial</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="acqdp.circuit.html"
                        title="next chapter">acqdp.circuit package</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><h3>See Also</h3>
<ul>
<li><a href="https://github.com/alibaba/acqdp">Source code on Github</a></li>
<li><a href="https://pypi.org/project/acqdp/">PyPI Project</a></li>
</ul>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="acqdp.circuit.html" title="acqdp.circuit package"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="Tutorial"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Alibaba Cloud Quantum Development Platform 0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Tensor network and its contractions</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Alibaba Quantum Laboratory.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>